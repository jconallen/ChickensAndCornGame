<!DOCTYPE html>
<html lang="en">
<head>
	<title>Chickens and Corn Game</title>
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
 	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.css" />	
  	<link rel="stylesheet" href="css/cnc.css" >
 	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> 
	<script src="https://cdnjs.cloudflare.com/ajax/libs/todc-bootstrap/3.3.7-3.3.13/js/bootstrap.min.js"></script>
 	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-modal/2.2.6/js/bootstrap-modalmanager.min.js"></script>
 	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.11.1/bootstrap-table.min.js"></script>
 	<link rel="icon" type="image/png" href="images/chicken-icon.png">
</head>

<body>

<div class="container" >

	<div class="container" style="padding:15px;">
		<div class="row">
	    	<div class="col-md-12">
	    		<h1>Chickens and Corn Game <img src="images/chicken-icon.png" style="width:64px;"></h1>
	    		<a href="api.html" target="_blank">API</a> |
	    		<a href="about.html" target="_blank">About</a> 
	    	</div>
	    	
	 	</div>
	</div>
   

 	<div class="row">
	    <div class="col-md-12">
		    <div class="panel panel-primary" >
		    	<div class="panel-heading" >
					<h3 class="panel-title">Controls</h3>
				</div>
				<div class="panel-body" >
					
						<button type="button" class="btn btn-default" onclick="next()" id="nextBtn">
							<span class="glyphicon glyphicon-step-forward"></span> Next Move
						</button>
						<!-- 
						<button type="button" class="btn btn-default" onclick="run()" id="runBtn">
							<span class="glyphicon glyphicon-play"></span> Run to Completion
						</button>
						 -->
						<button type="button" class="btn btn-default" onclick="restart()" id="restartBtn">
							<span class="glyphicon glyphicon-refresh"></span> Restart
						</button>
						<button type="button" class="btn btn-default" onclick="updateAlgorithms()" id="updateBtn">
							<span class="glyphicon glyphicon-cloud-upload"></span> Update Algorithms
						</button>
				</div>
		    </div>
	    </div>

    </div>
    
 	<div class="row">
	 	<div class="col-md-4">
	 	
			<div class="panel panel-info" >
				<div class="panel-heading" >
			    	<h3 id="titleGameboard" class="panel-title">Gameboard</h3>
			    </div>
			    <div class="panel-body" style="min-height: 500px; margin-top: 0; margin-bottom: 0; padding-top: 0; padding-bottom:0;">
			    	<table id="gameboard">
			    		<tr></tr>
						<tr>
							<td class="gameboard-cell"></td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">0</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">1</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">2</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">3</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">4</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">5</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">6</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray">7</td>
							<td ></td>
						</tr>
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">0</td>
							<td class="gameboard-cell gameboard-shaded" id="P0_0"></td>
							<td class="gameboard-cell" id="P1_0"></td>
							<td class="gameboard-cell gameboard-shaded" id="P2_0"></td>
							<td class="gameboard-cell" id="P3_0"></td>
							<td class="gameboard-cell gameboard-shaded" id="P4_0"></td>
							<td class="gameboard-cell" id="P5_0"></td>
							<td class="gameboard-cell gameboard-shaded" id="P6_0"></td>
							<td class="gameboard-cell"  style="border-right: 1px solid gray;" id="P7_0"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr>
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">1</td>
							<td class="gameboard-cell" id="P0_1"></td>
							<td class="gameboard-cell gameboard-shaded" id="P1_1"></td>
							<td class="gameboard-cell" id="P2_1"></td>
							<td class="gameboard-cell gameboard-shaded" id="P3_1"></td>
							<td class="gameboard-cell" id="P4_1"></td>
							<td class="gameboard-cell gameboard-shaded" id="P5_1"></td>
							<td class="gameboard-cell" id="P6_1"></td>
							<td class="gameboard-cell gameboard-shaded"  style="border-right: 1px solid gray" id="P7_1"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr>
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">2</td>
							<td class="gameboard-cell gameboard-shaded" id="P0_2"></td>
							<td class="gameboard-cell" id="P1_2"></td>
							<td class="gameboard-cell gameboard-shaded" id="P2_2"></td>
							<td class="gameboard-cell" id="P3_2"></td>
							<td class="gameboard-cell gameboard-shaded" id="P4_2"></td>
							<td class="gameboard-cell" id="P5_2"></td>
							<td class="gameboard-cell gameboard-shaded" id="P6_2"></td>
							<td class="gameboard-cell"  style="border-right: 1px solid gray" id="P7_2"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr>
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">3</td>
							<td class="gameboard-cell" id="P0_3"></td>
							<td class="gameboard-cell gameboard-shaded" id="P1_3"></td>
							<td class="gameboard-cell" id="P2_3"></td>
							<td class="gameboard-cell gameboard-shaded" id="P3_3"></td>
							<td class="gameboard-cell" id="P4_3"></td>
							<td class="gameboard-cell gameboard-shaded" id="P5_3"></td>
							<td class="gameboard-cell" id="P6_3"></td>
							<td class="gameboard-cell gameboard-shaded"  style="border-right: 1px solid gray" id="P7_3"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr>
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">4</td>
							<td class="gameboard-cell gameboard-shaded" id="P0_4"></td>
							<td class="gameboard-cell" id="P1_4"></td>
							<td class="gameboard-cell gameboard-shaded" id="P2_4"></td>
							<td class="gameboard-cell" id="P3_4"></td>
							<td class="gameboard-cell gameboard-shaded" id="P4_4"></td>
							<td class="gameboard-cell" id="P5_4"></td>
							<td class="gameboard-cell gameboard-shaded" id="P6_4"></td>
							<td class="gameboard-cell"  style="border-right: 1px solid gray" id="P7_4"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr> 
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">5</td>
							<td class="gameboard-cell" id="P0_5"></td>
							<td class="gameboard-cell gameboard-shaded" id="P1_5"></td>
							<td class="gameboard-cell" id="P2_5"></td>
							<td class="gameboard-cell gameboard-shaded" id="P3_5"></td>
							<td class="gameboard-cell" id="P4_5"></td>
							<td class="gameboard-cell gameboard-shaded" id="P5_5"></td>
							<td class="gameboard-cell" id="P6_5"></td>
							<td class="gameboard-cell gameboard-shaded"  style="border-right: 1px solid gray" id="P7_5"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr>
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">6</td>
							<td class="gameboard-cell gameboard-shaded" id="P0_6"></td>
							<td class="gameboard-cell" id="P1_6"></td>
							<td class="gameboard-cell gameboard-shaded" id="P2_6"></td>
							<td class="gameboard-cell" id="P3_6"></td>
							<td class="gameboard-cell gameboard-shaded" id="P4_6"></td>
							<td class="gameboard-cell" id="P5_6"></td>
							<td class="gameboard-cell gameboard-shaded" id="P6_6"></td>
							<td class="gameboard-cell"  style="border-right: 1px solid gray" id="P7_6"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr>
						<tr>
							<td class="gameboard-cell" style="border-right: 1px solid gray">7</td>
							<td class="gameboard-cell" style="border-bottom: 1px solid gray; border-bottom: 1px solid gray" id="P0_7"></td>
							<td class="gameboard-cell gameboard-shaded" id="P1_7"></td>
							<td class="gameboard-cell"  style="border-bottom: 1px solid gray; border-bottom: 1px solid gray" id="P2_7"></td>
							<td class="gameboard-cell gameboard-shaded" id="P3_7"></td>
							<td class="gameboard-cell"  style="border-bottom: 1px solid gray; border-bottom: 1px solid gray" id="P4_7"></td>
							<td class="gameboard-cell gameboard-shaded" id="P5_7"></td>
							<td class="gameboard-cell"  style="border-bottom: 1px solid gray; border-bottom: 1px solid gray" id="P6_7"></td>
							<td class="gameboard-cell gameboard-shaded"  style="border-bottom: 1px solid gray; border-right: 1px solid gray" id="P7_7"></td>
							<td style="border-left: 1px solid gray"></td>
						</tr>
						<tr>
							<td></td>
							<td style="border-top: 1px solid gray"></td>
							<td style="border-top: 1px solid gray"></td>
							<td style="border-top: 1px solid gray"></td>
							<td style="border-top: 1px solid gray"></td>
							<td style="border-top: 1px solid gray"></td>
							<td style="border-top: 1px solid gray"></td>
							<td style="border-top: 1px solid gray"></td>
							<td style="border-top: 1px solid gray"></td>
							<td ></td>
						</tr>
						
					</table>
					<div class="container" style="height: 200px; width: 100%; "><br>
 						<textarea id="console" style="width: 100%; min-height: 200px; font-family:'Courier'; font-size: 8pt;" > </textarea>
 					</div>

			  	</div>

			</div>
		
		</div>

            <div class="col-md-8">
               <div class="panel panel-success">
                  <div class="panel-heading">
                  <h3 id="titleAlgorithm" class="panel-title">Algorithms</h3>
                  </div>
                  <div class="panel-heading">
                     <ul class="nav nav-tabs">
                        <li><a class="nav-link" data-toggle="tab" href="#rooster">Rooster</a></li>
                        <li class="active"><a class="nav-link" data-toggle="tab" href="#farmer">Farmer</a></li>
                        <li><a class="nav-link" data-toggle="tab" href="#wife">Wife</a></li>
                        <li><a class="nav-link" data-toggle="tab" href="#hen">Hen</a></li>
                     </ul>
                  </div>
                  <div class="panel-body" >
                  
                  <div class="tab-content" >
					<div id="rooster" class="container tab-pane" style="height: 100%; width: 100%; min-height: 400px;"><br>
 						<textarea id="roosterAlgorithm" style="min-width: 100%; min-height: 400px; font-family:'Courier'; font-size: 8pt;" > </textarea>
 					</div>
                  
					<div id="farmer" class="container tab-pane active" style="height: 100%; width: 100%; min-height: 400px;"><br>
 						<textarea id="farmerAlgorithm" style="width: 100%; height: 100%; min-height: 400px; font-family:'Courier'; font-size: 8pt;" ></textarea>
 					</div>
                  
					<div id="wife" class="container tab-pane" style="height: 100%; width: 100%; min-height: 400px;"><br>
 						<textarea id="wifeAlgorithm" style="width:100%; height: 100%; min-height: 400px; font-family:'Courier'; font-size: 8pt;" ></textarea>
 					</div>
                  
					<div id="hen" class="container tab-pane" style="height: 100%; width: 100%; min-height: 400px;"><br>
 						<textarea id="henAlgorithm" style="width:100%; height: 100%; min-height: 400px; font-family:'Courier'; font-size: 8pt;" ></textarea>
 					</div>
                  
                  </div>
               </div>
            </div>
   </div>

	
	
	
	</div> <!--  outer container -->
	    
	<script src="js/game.js"></script>
	<script type="text/javascript">
	
	function updateDisplay(){
		var board = document.getElementById("gameboard");
		Game._setBoard(board);
		
		var title = document.getElementById("titleGameboard");
		title.innerHTML = "Gameboard - Moves: " + Game.moves();
		
		// update algorithm boxes
		var elm;
		
		elm = document.getElementById("roosterAlgorithm");
		if( elm ) {
			elm.innerHTML = Rooster._algorithm;
		} 
		elm = document.getElementById("farmerAlgorithm");
		if( elm ) {
			elm.innerHTML = Farmer._algorithm;
		} 
		elm = document.getElementById("wifeAlgorithm");
		if( elm ) {
			elm.innerHTML = Wife._algorithm;
		} 
		elm = document.getElementById("henAlgorithm");
		if( elm ) {
			elm.innerHTML = Hen._algorithm;
		} 
		
	}

	function next(){
		try{
			if( !Game._next() ) {
				// if returns true, then game over, .. man.
				
				var elm;
				elm = document.getElementById("nextBtn");
				elm.disabled = true;
				//elm = document.getElementById("runBtn");
				//elm.disabled = true;
			};
			
		} catch( err ) {
			alert(err);
		}
		updateDisplay();
	}
	
	function run(){
		while( ! next() ){
			updateDisplay();
			pause(2000);
		}
	}
	
	function restart(){
		Game._reset();
		var elm;
		elm = document.getElementById("nextBtn");
		elm.disabled = false;
		//elm = document.getElementById("runBtn");
		//elm.disabled = false;
		elm = document.getElementById("console");
		elm.value = "";
		updateDisplay();
	}
	
	function updateAlgorithms(){
		var elm;
		var algorithm;

		elm = document.getElementById("roosterAlgorithm");
		algorithm = elm.value;
		Rooster._algorithm = algorithm;
		
		elm = document.getElementById("farmerAlgorithm");
		algorithm = elm.value;
		Farmer._algorithm = algorithm;

		elm = document.getElementById("wifeAlgorithm");
		algorithm = elm.value;
		Wife._algorithm = algorithm;

		elm = document.getElementById("henAlgorithm");
		algorithm = elm.value;
		Hen._algorithm = algorithm;
}
	
	function readDefaultAlgorithm(piece, url)	{
	    var rawFile = new XMLHttpRequest();
	    rawFile.open("GET", url, false);
	    rawFile.onreadystatechange = function (){
	        if(rawFile.readyState === 4){
	            if(rawFile.status === 200 || rawFile.status == 0) {
	                var allText = rawFile.responseText;
	                piece._algorithm = allText;
	                restart();
	            }
	        }
	    }
	    rawFile.send(null);
	}
	

	var Rooster = new Piece("Rooster", new Position(4,0), "Game.randomMove(Rooster);");
	var Farmer = new Piece("Farmer", new Position(4,2), "Game.randomMove(Farmer);");
	var Wife = new Piece("Wife", new Position(4,5), "Game.randomMove(Wife);");
	var Hen = new Piece("Hen", new Position(4,7), "Game.randomMove(Hen);");
	var Game = new _Game(Rooster, Farmer, Wife, Hen);
	var Me;  // the current piece

	readDefaultAlgorithm(Rooster, "js/rooster.js");
	readDefaultAlgorithm(Farmer, "js/farmer.js");
	readDefaultAlgorithm(Wife, "js/wife.js");
	readDefaultAlgorithm(Hen, "js/hen.js");

	
	restart();
	
	</script>

  </body>
</html>


